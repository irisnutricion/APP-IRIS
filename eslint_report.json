[{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\postcss.config.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Dashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Layout.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useNavigate' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useNavigate"},"fix":{"range":[15,28],"text":""},"desc":"Remove unused variable 'useNavigate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":22,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[477,488],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Outlet, useNavigate, useLocation, Link } from 'react-router-dom';\r\nimport {\r\n    LayoutDashboard,\r\n    Users,\r\n    CalendarDays,\r\n    Megaphone,\r\n    Settings,\r\n    LogOut,\r\n    Menu,\r\n    X,\r\n    UserCircle,\r\n    Activity,\r\n    Repeat,\r\n    PieChart,\r\n    ClipboardList\r\n} from 'lucide-react';\r\nimport { useState } from 'react';\r\nimport { cn } from '../utils/cn';\r\nimport { ThemeToggle } from './ThemeToggle.jsx';\r\n\r\n// Sidebar Item Component\r\nconst SidebarItem = ({ icon: Icon, label, path, active }) => (\r\n    <Link\r\n        to={path}\r\n        className={cn(\r\n            \"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors mb-1\",\r\n            active\r\n                ? \"bg-primary-50 text-primary-700 font-medium dark:bg-primary-900/20 dark:text-primary-400\"\r\n                : \"text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-400 dark:hover:bg-slate-800 dark:hover:text-slate-50\"\r\n        )}\r\n    >\r\n        <Icon className=\"w-5 h-5\" />\r\n        <span>{label}</span>\r\n    </Link>\r\n);\r\n\r\nconst Sidebar = ({ isOpen, onClose }) => {\r\n    const location = useLocation();\r\n\r\n    // Adapted Navigation Items for Nutri CRM\r\n    const navItems = [\r\n        { icon: LayoutDashboard, label: 'Dashboard', path: '/' },\r\n        { icon: Users, label: 'Clientes', path: '/patients' },\r\n        { icon: Activity, label: 'Seguimiento', path: '/tracking' },\r\n        { icon: Repeat, label: 'Renovaciones', path: '/renewals' },\r\n        { icon: ClipboardList, label: 'Tareas', path: '/tasks' },\r\n        { icon: Megaphone, label: 'Marketing', path: '/marketing' },\r\n        { icon: PieChart, label: 'Estadísticas', path: '/statistics' },\r\n        { icon: CalendarDays, label: 'Calendario', path: '/calendar' }, // Future feature?\r\n        { icon: Settings, label: 'Configuración', path: '/settings' },\r\n    ];\r\n\r\n    // Handle Closing on Mobile Navigation\r\n    const handleNavClick = () => {\r\n        if (window.innerWidth < 768) {\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Mobile Overlay */}\r\n            {isOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/50 z-20 md:hidden transition-opacity\"\r\n                    onClick={onClose}\r\n                />\r\n            )}\r\n\r\n            {/* Sidebar */}\r\n            <div className={cn(\r\n                \"w-64 h-full bg-white border-r border-slate-200 flex flex-col fixed left-0 top-0 transition-transform duration-300 z-30 dark:bg-slate-900 dark:border-slate-800\",\r\n                isOpen ? \"translate-x-0\" : \"-translate-x-full md:translate-x-0\"\r\n            )}>\r\n                <div className=\"p-6 flex items-center justify-between border-b border-slate-100 dark:border-slate-800\">\r\n                    <div className=\"flex items-center justify-center flex-1\">\r\n                        <div className=\"flex flex-col items-center justify-center py-2\">\r\n                            <img src=\"/logo-rosa.png\" alt=\"NutriCRM Logo\" className=\"h-16 w-auto object-contain mb-2\" />\r\n                            <span className=\"text-sm font-bold text-primary-700 tracking-widest uppercase\">Iris Nutrición</span>\r\n                        </div>\r\n                    </div>\r\n                    <button onClick={onClose} className=\"md:hidden p-1 text-slate-500\">\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <nav className=\"flex-1 overflow-y-auto p-4\">\r\n                    {navItems.map((item) => (\r\n                        <div key={item.path} onClick={handleNavClick}>\r\n                            <SidebarItem\r\n                                icon={item.icon}\r\n                                label={item.label}\r\n                                path={item.path}\r\n                                active={location.pathname === item.path || (item.path !== '/' && location.pathname.startsWith(item.path))}\r\n                            />\r\n                        </div>\r\n                    ))}\r\n                </nav>\r\n\r\n                <div className=\"p-4 border-t border-slate-100 dark:border-slate-800\">\r\n                    <div className=\"flex items-center space-x-3 px-3 py-2\">\r\n                        <div className=\"bg-primary-100 p-2 rounded-full dark:bg-primary-900/30\">\r\n                            <UserCircle className=\"w-5 h-5 text-primary-600 dark:text-primary-400\" />\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"text-sm font-medium text-slate-900 truncate dark:text-slate-200\">Dra. Iris</p>\r\n                            <p className=\"text-xs text-slate-500 truncate capitalize dark:text-slate-400\">Nutricionista</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default function Layout() {\r\n    const [sidebarOpen, setSidebarOpen] = useState(false);\r\n\r\n    // Mock Logout\r\n    const handleLogout = () => {\r\n        console.log(\"Logout clicked\");\r\n        // Could implement real logout if needed\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 transition-colors duration-300 dark:bg-slate-950\">\r\n            <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\r\n\r\n            <div className=\"md:pl-64 flex flex-col min-h-screen transition-all duration-300\">\r\n                <header className=\"h-16 bg-white border-b border-slate-200 flex items-center justify-between md:justify-end px-4 md:px-8 sticky top-0 z-10 transition-colors duration-300 gap-4 dark:bg-slate-900 dark:border-slate-800\">\r\n                    {/* Mobile Menu Button */}\r\n                    <button\r\n                        className=\"md:hidden p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-lg dark:text-slate-400 dark:hover:bg-slate-800\"\r\n                        onClick={() => setSidebarOpen(true)}\r\n                    >\r\n                        <Menu className=\"w-6 h-6\" />\r\n                    </button>\r\n\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <ThemeToggle />\r\n                        <div className=\"h-6 w-px bg-slate-200 dark:bg-slate-700\" aria-hidden=\"true\" />\r\n                        <button\r\n                            onClick={handleLogout}\r\n                            className=\"flex items-center space-x-2 text-sm text-slate-600 hover:text-red-600 transition-colors dark:text-slate-400 dark:hover:text-red-400\"\r\n                        >\r\n                            <LogOut className=\"w-4 h-4\" />\r\n                            <span className=\"hidden sm:inline\">Cerrar Sesión</span>\r\n                        </button>\r\n                    </div>\r\n                </header>\r\n                <main className=\"flex-1 p-4 md:p-8 overflow-x-hidden\">\r\n                    <Outlet />\r\n                </main>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\CalendarPost.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\ContentCalendar.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'dayIdx' is defined but never used.","line":133,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":133,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"dayIdx"},"fix":{"range":[5695,5703],"text":""},"desc":"Remove unused variable 'dayIdx'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport {\r\n    format,\r\n    startOfMonth,\r\n    endOfMonth,\r\n    startOfWeek,\r\n    endOfWeek,\r\n    eachDayOfInterval,\r\n    addMonths,\r\n    subMonths,\r\n    addWeeks,\r\n    subWeeks,\r\n    isSameMonth,\r\n    isSameDay,\r\n    isToday,\r\n    parseISO\r\n} from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport { ChevronLeft, ChevronRight, Calendar as CalendarIcon, Grid } from 'lucide-react';\r\nimport CalendarPost from './CalendarPost';\r\n\r\nconst ContentCalendar = ({ posts, onPostClick, onNewPost }) => {\r\n    const [currentDate, setCurrentDate] = useState(new Date());\r\n    const [viewMode, setViewMode] = useState('month'); // 'month' or 'week'\r\n\r\n    // Navigation Handlers\r\n    const nextPeriod = () => {\r\n        if (viewMode === 'month') {\r\n            setCurrentDate(addMonths(currentDate, 1));\r\n        } else {\r\n            setCurrentDate(addWeeks(currentDate, 1));\r\n        }\r\n    };\r\n\r\n    const prevPeriod = () => {\r\n        if (viewMode === 'month') {\r\n            setCurrentDate(subMonths(currentDate, 1));\r\n        } else {\r\n            setCurrentDate(subWeeks(currentDate, 1));\r\n        }\r\n    };\r\n\r\n    const jumpToToday = () => setCurrentDate(new Date());\r\n\r\n    // Generate Calendar Days\r\n    const generateCalendarDays = () => {\r\n        const viewStart = viewMode === 'month'\r\n            ? startOfWeek(startOfMonth(currentDate), { weekStartsOn: 1 })\r\n            : startOfWeek(currentDate, { weekStartsOn: 1 });\r\n\r\n        const viewEnd = viewMode === 'month'\r\n            ? endOfWeek(endOfMonth(currentDate), { weekStartsOn: 1 })\r\n            : endOfWeek(currentDate, { weekStartsOn: 1 });\r\n\r\n        return eachDayOfInterval({ start: viewStart, end: viewEnd });\r\n    };\r\n\r\n    const days = generateCalendarDays();\r\n    const weekMock = ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'];\r\n\r\n    // Post filtering helper\r\n    const getPostsForDay = (day) => {\r\n        return posts.filter(post => isSameDay(parseISO(post.date), day));\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full\">\r\n            {/* Calendar Header */}\r\n            <div className=\"p-4 border-b border-slate-200 flex flex-wrap items-center justify-between gap-4\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <h2 className=\"text-lg font-bold text-slate-800 capitalize min-w-[180px]\">\r\n                        {format(currentDate, viewMode === 'month' ? 'MMMM yyyy' : \"'Semana del' d 'de' MMMM\", { locale: es })}\r\n                    </h2>\r\n                    <div className=\"flex items-center bg-slate-100 rounded-lg p-1\">\r\n                        <button\r\n                            onClick={prevPeriod}\r\n                            className=\"p-1 hover:bg-white hover:shadow-sm rounded-md transition-all text-slate-600\"\r\n                        >\r\n                            <ChevronLeft size={18} />\r\n                        </button>\r\n                        <button\r\n                            onClick={nextPeriod}\r\n                            className=\"p-1 hover:bg-white hover:shadow-sm rounded-md transition-all text-slate-600\"\r\n                        >\r\n                            <ChevronRight size={18} />\r\n                        </button>\r\n                        <button\r\n                            onClick={jumpToToday}\r\n                            className=\"px-3 py-1 text-xs font-medium text-slate-600 hover:bg-white hover:shadow-sm rounded-md ml-1 transition-all\"\r\n                        >\r\n                            Hoy\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex bg-slate-100 p-1 rounded-lg\">\r\n                    <button\r\n                        onClick={() => setViewMode('month')}\r\n                        className={`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-all ${viewMode === 'month'\r\n                                ? 'bg-white text-primary-700 shadow-sm'\r\n                                : 'text-slate-500 hover:text-slate-700'\r\n                            }`}\r\n                    >\r\n                        <Grid size={16} />\r\n                        <span className=\"hidden sm:inline\">Mes</span>\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setViewMode('week')}\r\n                        className={`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-all ${viewMode === 'week'\r\n                                ? 'bg-white text-primary-700 shadow-sm'\r\n                                : 'text-slate-500 hover:text-slate-700'\r\n                            }`}\r\n                    >\r\n                        <CalendarIcon size={16} />\r\n                        <span className=\"hidden sm:inline\">Semana</span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Calendar Grid */}\r\n            <div className=\"flex-1 flex flex-col min-h-[600px]\">\r\n                {/* Weekday Headers */}\r\n                <div className=\"grid grid-cols-7 border-b border-slate-200 bg-slate-50\">\r\n                    {weekMock.map(day => (\r\n                        <div key={day} className=\"py-2 text-center text-xs font-semibold text-slate-500 uppercase tracking-wider\">\r\n                            {day}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Days Grid */}\r\n                <div className={`grid grid-cols-7 flex-1 ${viewMode === 'month' ? 'grid-rows-5' : 'grid-rows-1'}`}>\r\n                    {days.map((day, dayIdx) => {\r\n                        const dayPosts = getPostsForDay(day);\r\n                        const isCurrentMonth = isSameMonth(day, currentDate);\r\n\r\n                        return (\r\n                            <div\r\n                                key={day.toString()}\r\n                                onClick={() => onNewPost(day)}\r\n                                className={`\r\n                                    min-h-[120px] p-2 border-b border-r border-slate-100 hover:bg-slate-50/50 transition-colors cursor-pointer group relative\r\n                                    ${!isCurrentMonth && viewMode === 'month' ? 'bg-slate-50/30' : 'bg-white'}\r\n                                    ${isToday(day) ? 'bg-primary-50/30' : ''}\r\n                                `}\r\n                            >\r\n                                <div className=\"flex items-center justify-between mb-2\">\r\n                                    <span\r\n                                        className={`\r\n                                            w-7 h-7 flex items-center justify-center rounded-full text-sm font-medium\r\n                                            ${isToday(day) ? 'bg-primary-600 text-white' : isCurrentMonth ? 'text-slate-700' : 'text-slate-400'}\r\n                                        `}\r\n                                    >\r\n                                        {format(day, 'd')}\r\n                                    </span>\r\n                                    {/* Quick add button visible on hover */}\r\n                                    <div className=\"opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                        <div className=\"w-6 h-6 rounded-full bg-primary-100 text-primary-600 flex items-center justify-center hover:bg-primary-200\">\r\n                                            <span className=\"text-lg leading-none mb-0.5\">+</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-1\">\r\n                                    {dayPosts.map(post => (\r\n                                        <div key={post.id} onClick={(e) => { e.stopPropagation(); onPostClick(post); }}>\r\n                                            <CalendarPost post={post} onClick={onPostClick} />\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ContentCalendar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\Marketing.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\NewPostModal.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  13 |         if (isOpen) {\n  14 |             if (initialData) {\n> 15 |                 setPost(initialData);\n     |                 ^^^^^^^ Avoid calling setState() directly within an effect\n  16 |             } else {\n  17 |                 setPost({\n  18 |                     date: selectedDate ? selectedDate.toISOString().split('T')[0] : new Date().toISOString().split('T')[0],","line":15,"column":17,"nodeType":null,"endLine":15,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { X, Save, Trash2 } from 'lucide-react';\r\n\r\nconst NewPostModal = ({ isOpen, onClose, onSave, onDelete, initialData, selectedDate }) => {\r\n    const [post, setPost] = useState({\r\n        date: '',\r\n        platform: 'Instagram',\r\n        content: '',\r\n        status: 'idea'\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            if (initialData) {\r\n                setPost(initialData);\r\n            } else {\r\n                setPost({\r\n                    date: selectedDate ? selectedDate.toISOString().split('T')[0] : new Date().toISOString().split('T')[0],\r\n                    platform: 'Instagram',\r\n                    content: '',\r\n                    status: 'idea'\r\n                });\r\n            }\r\n        }\r\n    }, [isOpen, initialData, selectedDate]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        onSave(post);\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\">\r\n            <div className=\"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200\">\r\n                <div className=\"flex items-center justify-between p-4 border-b border-gray-100\">\r\n                    <h3 className=\"font-semibold text-lg text-gray-900\">\r\n                        {initialData ? 'Editar Publicación' : 'Nueva Publicación'}\r\n                    </h3>\r\n                    <button onClick={onClose} className=\"text-gray-400 hover:text-gray-600 p-1 rounded-lg hover:bg-gray-100 transition-colors\">\r\n                        <X size={20} />\r\n                    </button>\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\r\n                    <div className=\"space-y-1.5\">\r\n                        <label className=\"block text-sm font-medium text-gray-700\">Fecha</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            required\r\n                            value={post.date}\r\n                            onChange={e => setPost({ ...post, date: e.target.value })}\r\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-1.5\">\r\n                        <label className=\"block text-sm font-medium text-gray-700\">Plataforma</label>\r\n                        <select\r\n                            value={post.platform}\r\n                            onChange={e => setPost({ ...post, platform: e.target.value })}\r\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all bg-white\"\r\n                        >\r\n                            <option value=\"Instagram\">Instagram</option>\r\n                            <option value=\"Facebook\">Facebook</option>\r\n                            <option value=\"TikTok\">TikTok</option>\r\n                            <option value=\"Blog\">Blog</option>\r\n                            <option value=\"Email\">Email Newsletter</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-1.5\">\r\n                        <label className=\"block text-sm font-medium text-gray-700\">Contenido / Idea</label>\r\n                        <textarea\r\n                            required\r\n                            rows={4}\r\n                            value={post.content}\r\n                            onChange={e => setPost({ ...post, content: e.target.value })}\r\n                            placeholder=\"Describe el contenido del post...\"\r\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all resize-none\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-1.5\">\r\n                        <label className=\"block text-sm font-medium text-gray-700\">Estado</label>\r\n                        <div className=\"flex gap-2\">\r\n                            {['idea', 'scheduled', 'published'].map((status) => (\r\n                                <button\r\n                                    key={status}\r\n                                    type=\"button\"\r\n                                    onClick={() => setPost({ ...post, status })}\r\n                                    className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium capitalize border transition-all ${post.status === status\r\n                                            ? 'bg-primary-50 border-primary-200 text-primary-700'\r\n                                            : 'bg-white border-gray-200 text-gray-600 hover:bg-gray-50'\r\n                                        }`}\r\n                                >\r\n                                    {status === 'idea' ? 'Borrador' : status === 'scheduled' ? 'Programado' : 'Publicado'}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-4 flex items-center justify-between gap-3\">\r\n                        {initialData ? (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => {\r\n                                    if (window.confirm('¿Eliminar este post?')) {\r\n                                        onDelete(initialData.id);\r\n                                        onClose();\r\n                                    }\r\n                                }}\r\n                                className=\"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm font-medium\"\r\n                            >\r\n                                <Trash2 size={18} />\r\n                                Eliminar\r\n                            </button>\r\n                        ) : (\r\n                            <div></div> // Spacer\r\n                        )}\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={onClose}\r\n                                className=\"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors text-sm font-medium\"\r\n                            >\r\n                                Cancelar\r\n                            </button>\r\n                            <button\r\n                                type=\"submit\"\r\n                                className=\"flex items-center gap-2 px-6 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg shadow-sm hover:shadow transition-all text-sm font-medium\"\r\n                            >\r\n                                <Save size={18} />\r\n                                Guardar\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default NewPostModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Patients\\PatientDetail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Patients\\PatientForm.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  31 |             const patient = patients.find(p => p.id === id);\n  32 |             if (patient) {\n> 33 |                 setFormData({\n     |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  34 |                     name: patient.name || '',\n  35 |                     age: patient.age || '',\n  36 |                     sex: patient.sex || 'mujer',","line":33,"column":17,"nodeType":null,"endLine":33,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { useData } from '../../context/DataContext';\r\nimport { addDays } from 'date-fns';\r\nimport { Save, ArrowLeft, User, Activity, Heart, CreditCard } from 'lucide-react';\r\n\r\nconst PatientForm = () => {\r\n    const { id } = useParams();\r\n    const navigate = useNavigate();\r\n    const { patients, addPatient, updatePatient, plans } = useData();\r\n    const isEdit = !!id;\r\n\r\n    const [formData, setFormData] = useState({\r\n        name: '',\r\n        age: '',\r\n        sex: 'mujer', // Default\r\n        city: '',\r\n        phone: '',\r\n        email: '',\r\n        height: '',\r\n        weight: '', // Initial weight\r\n        goals: '',\r\n        allergies: '',\r\n        referralSource: '',\r\n        planType: plans.length > 0 ? plans[0].id : '', // Default to first plan\r\n        startDate: new Date().toISOString().split('T')[0]\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (isEdit) {\r\n            const patient = patients.find(p => p.id === id);\r\n            if (patient) {\r\n                setFormData({\r\n                    name: patient.name || '',\r\n                    age: patient.age || '',\r\n                    sex: patient.sex || 'mujer',\r\n                    city: patient.city || '',\r\n                    phone: patient.phone || '',\r\n                    email: patient.email || '',\r\n                    height: patient.height || '',\r\n                    weight: patient.weight || '',\r\n                    goals: patient.goals || '',\r\n                    allergies: patient.allergies || '',\r\n                    referralSource: patient.referralSource || '',\r\n                    planType: patient.subscription?.type || (plans.length > 0 ? plans[0].id : ''),\r\n                    startDate: patient.subscription?.startDate || new Date().toISOString().split('T')[0]\r\n                });\r\n            }\r\n        }\r\n    }, [isEdit, id, patients, plans]);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n\r\n        // Calculate subscription end date\r\n        const selectedPlan = plans.find(p => p.id === formData.planType);\r\n        const durationDays = selectedPlan ? selectedPlan.days : 30; // Fallback\r\n\r\n        const subscription = {\r\n            type: selectedPlan ? selectedPlan.name : 'Custom',\r\n            planId: formData.planType, // Store ID for reference\r\n            startDate: formData.startDate,\r\n            endDate: addDays(new Date(formData.startDate), durationDays).toISOString().split('T')[0],\r\n            status: 'active'\r\n        };\r\n\r\n        const patientData = {\r\n            ...formData,\r\n            subscription\r\n        };\r\n\r\n        if (isEdit) {\r\n            updatePatient(id, patientData);\r\n        } else {\r\n            addPatient(patientData);\r\n        }\r\n        navigate('/patients');\r\n    };\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({ ...prev, [name]: value }));\r\n    };\r\n\r\n    return (\r\n        <div className=\"dashboard-container\">\r\n            <div className=\"dashboard-header\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <button onClick={() => navigate(-1)} className=\"btn btn-ghost btn-icon\">\r\n                        <ArrowLeft size={24} />\r\n                    </button>\r\n                    <div>\r\n                        <h1 className=\"page-title\">{isEdit ? 'Editar Cliente' : 'Nuevo Cliente'}</h1>\r\n                        <p className=\"page-subtitle\">Complete la ficha técnica</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <form onSubmit={handleSubmit} className=\"card max-w-4xl mx-auto\">\r\n\r\n                {/* Personal Data */}\r\n                <div className=\"text-lg font-bold text-slate-800 border-b border-slate-100 pb-2 mb-4 flex items-center gap-2\">\r\n                    <User size={18} className=\"text-primary-600\" /> Datos Personales\r\n                </div>\r\n\r\n\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n                    <div className=\"form-group md:col-span-2\">\r\n                        <label className=\"form-label\">Nombre Completo</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"name\"\r\n                            value={formData.name}\r\n                            onChange={handleChange}\r\n                            required\r\n                            placeholder=\"Ej. Ana López\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Edad</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"age\"\r\n                            type=\"number\"\r\n                            value={formData.age}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. 30\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Sexo</label>\r\n                        <select\r\n                            className=\"form-select\"\r\n                            name=\"sex\"\r\n                            value={formData.sex}\r\n                            onChange={handleChange}\r\n                        >\r\n                            <option value=\"mujer\">Mujer</option>\r\n                            <option value=\"hombre\">Hombre</option>\r\n                            <option value=\"otro\">Otro</option>\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Ciudad / Localidad</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"city\"\r\n                            value={formData.city}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. Madrid\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Teléfono</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"phone\"\r\n                            type=\"tel\"\r\n                            value={formData.phone}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. 600 123 456\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group md:col-span-2\">\r\n                        <label className=\"form-label\">Email</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            value={formData.email}\r\n                            onChange={handleChange}\r\n                            placeholder=\"ejemplo@email.com\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Physical Data */}\r\n                <div className=\"text-lg font-bold text-slate-800 border-b border-slate-100 pb-2 mb-4 flex items-center gap-2\">\r\n                    <Activity size={18} className=\"text-primary-600\" /> Datos Físicos Iniciales\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Altura (cm)</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"height\"\r\n                            type=\"number\"\r\n                            value={formData.height}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. 165\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Peso Actual (kg)</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"weight\"\r\n                            type=\"number\"\r\n                            step=\"0.1\"\r\n                            value={formData.weight}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. 65.5\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Goals & Medical */}\r\n                <div className=\"text-lg font-bold text-slate-800 border-b border-slate-100 pb-2 mb-4 flex items-center gap-2\">\r\n                    <Heart size={18} className=\"text-primary-600\" /> Objetivos y Salud\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n                    <div className=\"form-group md:col-span-2\">\r\n                        <label className=\"form-label\">Objetivos Nutricionales</label>\r\n                        <textarea\r\n                            className=\"form-textarea\"\r\n                            name=\"goals\"\r\n                            rows=\"3\"\r\n                            value={formData.goals}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. Perder grasa, aumentar masa muscular...\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group md:col-span-2\">\r\n                        <label className=\"form-label\">Alergias / Intolerancias</label>\r\n                        <textarea\r\n                            className=\"form-textarea\"\r\n                            name=\"allergies\"\r\n                            rows=\"2\"\r\n                            value={formData.allergies}\r\n                            onChange={handleChange}\r\n                            placeholder=\"Ej. Intolerancia a la lactosa, alergia a nueces...\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Marketing */}\r\n                <div className=\"text-lg font-bold text-slate-800 border-b border-slate-100 pb-2 mb-4 flex items-center gap-2\">\r\n                    <Heart size={18} className=\"text-primary-600\" /> Otros Datos\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">¿Cómo nos conoció?</label>\r\n                        <select\r\n                            className=\"form-select\"\r\n                            name=\"referralSource\"\r\n                            value={formData.referralSource}\r\n                            onChange={handleChange}\r\n                        >\r\n                            <option value=\"\">Seleccionar...</option>\r\n                            <option value=\"instagram\">Instagram</option>\r\n                            <option value=\"google\">Google</option>\r\n                            <option value=\"recomendacion\">Recomendación</option>\r\n                            <option value=\"publicidad\">Publicidad</option>\r\n                            <option value=\"otro\">Otro</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Subscription */}\r\n                <div className=\"text-lg font-bold text-slate-800 border-b border-slate-100 pb-2 mb-4 flex items-center gap-2\">\r\n                    <CreditCard size={18} className=\"text-primary-600\" /> Plan y Suscripción\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Tipo de Plan</label>\r\n                        <select className=\"form-select\" name=\"planType\" value={formData.planType} onChange={handleChange}>\r\n                            <option value=\"\" disabled>Seleccionar tarifa...</option>\r\n                            {plans.map(plan => (\r\n                                <option key={plan.id} value={plan.id}>\r\n                                    {plan.name} ({plan.days} días)\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"form-label\">Fecha de Inicio</label>\r\n                        <input\r\n                            className=\"form-input\"\r\n                            name=\"startDate\"\r\n                            type=\"date\"\r\n                            value={formData.startDate}\r\n                            onChange={handleChange}\r\n                            required\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"form-actions\">\r\n                    <button type=\"button\" onClick={() => navigate(-1)} className=\"btn btn-outline\">Cancelar</button>\r\n                    <button type=\"submit\" className=\"btn btn-primary px-8\">\r\n                        <Save size={18} /> Guardar Cliente\r\n                    </button>\r\n                </div>\r\n\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PatientForm;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Patients\\PatientList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Renewals\\Renewals.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isAfter' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"isAfter"},"fix":{"range":[88,97],"text":""},"desc":"Remove unused variable 'isAfter'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isSameMonth' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"isSameMonth"},"fix":{"range":[97,110],"text":""},"desc":"Remove unused variable 'isSameMonth'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setCurrentMonth' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"setCurrentMonth"},"fix":{"range":[505,522],"text":""},"desc":"Remove unused variable 'setCurrentMonth'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useData } from '../../context/DataContext';\r\nimport { addDays, format, isBefore, isAfter, isSameMonth, parseISO, startOfMonth, endOfMonth, eachDayOfInterval, isSameDay } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport { Calendar, AlertTriangle, CheckCircle, Clock, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst Renewals = () => {\r\n    const { patients } = useData();\r\n    const [currentMonth, setCurrentMonth] = useState(new Date());\r\n\r\n    // Filter patients with subscriptions\r\n    const activeSubs = patients.filter(p => p.subscription);\r\n\r\n    // Logic for status\r\n    const getStatus = (endDate) => {\r\n        const end = parseISO(endDate);\r\n        const today = new Date();\r\n        const warningDate = addDays(today, 7);\r\n\r\n        if (isBefore(end, today)) return 'expired';\r\n        if (isBefore(end, warningDate)) return 'warning';\r\n        return 'active';\r\n    };\r\n\r\n    const upcomingRenewals = activeSubs.filter(p => {\r\n        const status = getStatus(p.subscription.endDate);\r\n        return status === 'warning';\r\n    });\r\n\r\n    const expiredRenewals = activeSubs.filter(p => {\r\n        const status = getStatus(p.subscription.endDate);\r\n        return status === 'expired';\r\n    });\r\n\r\n    // Calendar Logic\r\n    const monthStart = startOfMonth(currentMonth);\r\n    const monthEnd = endOfMonth(monthStart);\r\n    const calendarDays = eachDayOfInterval({ start: monthStart, end: monthEnd });\r\n\r\n    return (\r\n        <div className=\"dashboard-container\">\r\n            <div className=\"dashboard-header\">\r\n                <div>\r\n                    <h1 className=\"page-title\">Renovaciones</h1>\r\n                    <p className=\"page-subtitle\">Control de vencimientos y calendario</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Alerts Section */}\r\n            <div className=\"form-grid mb-8\">\r\n                <div className=\"card\" style={{ borderLeft: '4px solid var(--color-warning)' }}>\r\n                    <div className=\"card-header\">\r\n                        <h3 className=\"card-title flex items-center gap-2 text-warning\">\r\n                            <Clock size={20} className=\"text-warning\" /> Próximos a Vencer (7 días)\r\n                        </h3>\r\n                    </div>\r\n                    {upcomingRenewals.length === 0 ? (\r\n                        <p className=\"text-muted text-sm\">No hay renovaciones próximas.</p>\r\n                    ) : (\r\n                        <ul className=\"space-y-2\">\r\n                            {upcomingRenewals.map(p => (\r\n                                <li key={p.id} className=\"flex justify-between items-center bg-yellow-50 p-3 rounded-md\">\r\n                                    <span className=\"font-medium text-sm\">{p.name}</span>\r\n                                    <span className=\"badge badge-warning\">{format(parseISO(p.subscription.endDate), 'dd/MM')}</span>\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"card\" style={{ borderLeft: '4px solid var(--color-danger)' }}>\r\n                    <div className=\"card-header\">\r\n                        <h3 className=\"card-title flex items-center gap-2 text-danger\">\r\n                            <AlertTriangle size={20} className=\"text-danger\" /> Planes Vencidos\r\n                        </h3>\r\n                    </div>\r\n                    {expiredRenewals.length === 0 ? (\r\n                        <p className=\"text-muted text-sm\">No hay planes vencidos.</p>\r\n                    ) : (\r\n                        <ul className=\"space-y-2\">\r\n                            {expiredRenewals.map(p => (\r\n                                <Link to={`/patients/${p.id}`} key={p.id} className=\"flex justify-between items-center bg-red-50 p-3 rounded-md hover:bg-red-100 transition-colors\">\r\n                                    <span className=\"font-medium text-sm\">{p.name}</span>\r\n                                    <span className=\"badge badge-expired\">{format(parseISO(p.subscription.endDate), 'dd/MM')}</span>\r\n                                </Link>\r\n                            ))}\r\n                        </ul>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Calendar View */}\r\n            <div className=\"card\">\r\n                <div className=\"card-header\">\r\n                    <h3 className=\"card-title flex items-center gap-2\">\r\n                        <Calendar size={20} /> Calendario - {format(currentMonth, 'MMMM yyyy', { locale: es })}\r\n                    </h3>\r\n                    <div className=\"flex gap-2\">\r\n                        {/* Mock navigation for now */}\r\n                        <button className=\"btn btn-ghost btn-icon\"><ChevronLeft size={18} /></button>\r\n                        <button className=\"btn btn-ghost btn-icon\"><ChevronRight size={18} /></button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-7 gap-px bg-gray-200 border border-gray-200 rounded-lg overflow-hidden\">\r\n                    {['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'].map(d => (\r\n                        <div key={d} className=\"bg-gray-50 p-2 text-center text-xs font-semibold text-muted uppercase tracking-wider\">\r\n                            {d}\r\n                        </div>\r\n                    ))}\r\n\r\n                    {/* Pad start */}\r\n                    {Array(calendarDays[0].getDay()).fill(null).map((_, i) => (\r\n                        <div key={`pad-${i}`} className=\"bg-white min-h-[100px]\"></div>\r\n                    ))}\r\n\r\n                    {calendarDays.map(day => {\r\n                        const dayRenewals = activeSubs.filter(p => isSameDay(parseISO(p.subscription.endDate), day));\r\n                        const isToday = isSameDay(day, new Date());\r\n                        return (\r\n                            <div key={day.toString()} className={`bg-white min-h-[100px] p-2 hover:bg-gray-50 transition-colors ${isToday ? 'bg-green-50' : ''}`}>\r\n                                <div className={`text-right text-xs font-bold mb-1 ${isToday ? 'text-primary' : 'text-gray-400'}`}>\r\n                                    {format(day, 'd')}\r\n                                </div>\r\n                                <div className=\"space-y-1\">\r\n                                    {dayRenewals.map(p => (\r\n                                        <div key={p.id} className=\"text-[10px] bg-red-100 text-red-800 rounded px-1 py-0.5 truncate border border-red-200\" title={`Vence: ${p.name}`}>\r\n                                            {p.name}\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Renewals;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Settings\\Settings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Settings\\Statistics.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tasks\\Tasks.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\ThemeToggle.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tracking\\EvolutionChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tracking\\MeasurementModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tracking\\TrackingCalendar.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isWithinInterval' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":130,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":146,"suggestions":[{"messageId":"removeVar","data":{"varName":"isWithinInterval"},"fix":{"range":[265,283],"text":""},"desc":"Remove unused variable 'isWithinInterval'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'idx' is defined but never used.","line":169,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":169,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"idx"},"fix":{"range":[7993,7998],"text":""},"desc":"Remove unused variable 'idx'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'weekEnd' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":248,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":248,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"weekEnd"},"fix":{"range":[13536,13594],"text":""},"desc":"Remove unused variable 'weekEnd'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useData } from '../../context/DataContext';\r\nimport { addDays, format, startOfWeek, endOfWeek, startOfMonth, endOfMonth, eachDayOfInterval, isSameMonth, isSameDay, parseISO, isWithinInterval } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport { ChevronLeft, ChevronRight, Calendar as CalendarIcon, List, LayoutGrid, CheckSquare, Square, PenLine } from 'lucide-react';\r\n\r\nconst TrackingCalendar = () => {\r\n    const { patients, reviews, saveReview } = useData();\r\n    const navigate = useNavigate();\r\n    const [currentDate, setCurrentDate] = useState(new Date());\r\n    const [viewMode, setViewMode] = useState('week'); // Default to 'week'\r\n\r\n    // Generate Review Events\r\n    const events = patients.flatMap(patient => {\r\n        if (!patient.subscription?.startDate) return [];\r\n\r\n        const start = parseISO(patient.subscription.startDate);\r\n        const end = patient.subscription.endDate ? parseISO(patient.subscription.endDate) : addDays(start, 30); // Default or actual end\r\n        const patientEvents = [];\r\n\r\n        // Generate weekly reviews from start date\r\n        let reviewDate = addDays(start, 7);\r\n        while (reviewDate <= end) {\r\n            const reviewId = `review_${patient.id}_${format(reviewDate, 'yyyy-MM-dd')}`;\r\n            const savedData = reviews?.[reviewId] || {};\r\n\r\n            patientEvents.push({\r\n                sysId: reviewId,\r\n                date: reviewDate,\r\n                patientName: patient.name,\r\n                patientId: patient.id,\r\n                type: 'Revisión',\r\n                completed: savedData.completed || false,\r\n                notes: savedData.notes || ''\r\n            });\r\n            reviewDate = addDays(reviewDate, 7);\r\n        }\r\n        return patientEvents;\r\n    });\r\n\r\n    // Toggle Complete\r\n    const handleToggleComplete = (evt) => {\r\n        saveReview(evt.sysId, { completed: !evt.completed });\r\n    };\r\n\r\n    // Save Notes\r\n    const handleNotesChange = (sysId, note) => {\r\n        saveReview(sysId, { notes: note });\r\n    };\r\n\r\n    // Calendar Navigation\r\n    const nextPeriod = () => {\r\n        if (viewMode === 'week' || viewMode === 'list') {\r\n            setCurrentDate(addDays(currentDate, 7));\r\n        } else {\r\n            const next = new Date(currentDate);\r\n            next.setMonth(currentDate.getMonth() + 1);\r\n            setCurrentDate(next);\r\n        }\r\n    };\r\n\r\n    const prevPeriod = () => {\r\n        if (viewMode === 'week' || viewMode === 'list') {\r\n            setCurrentDate(addDays(currentDate, -7));\r\n        } else {\r\n            const prev = new Date(currentDate);\r\n            prev.setMonth(currentDate.getMonth() - 1);\r\n            setCurrentDate(prev);\r\n        }\r\n    };\r\n\r\n    // View Logic Dates\r\n    const monthStart = startOfMonth(currentDate);\r\n    const monthEnd = endOfMonth(monthStart);\r\n    const monthStartDate = startOfWeek(monthStart, { weekStartsOn: 1 });\r\n    const monthEndDate = endOfWeek(monthEnd, { weekStartsOn: 1 });\r\n\r\n    const weekStart = startOfWeek(currentDate, { weekStartsOn: 1 });\r\n    const weekEnd = endOfWeek(currentDate, { weekStartsOn: 1 });\r\n\r\n    // Determine days to render based on viewMode\r\n    const calendarDays = viewMode === 'week'\r\n        ? eachDayOfInterval({ start: weekStart, end: weekEnd })\r\n        : eachDayOfInterval({ start: monthStartDate, end: monthEndDate });\r\n\r\n    const weekDays = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];\r\n\r\n    // List View Grouping\r\n    const sortedEvents = [...events].sort((a, b) => a.date - b.date);\r\n\r\n    // Filter events for List View: Only show events for the CURRENT selected week (defined by weekStart and weekEnd)\r\n    const validListEvents = sortedEvents.filter(evt => {\r\n        return evt.date >= weekStart && evt.date <= weekEnd;\r\n    });\r\n\r\n    const eventsByWeek = validListEvents.reduce((acc, event) => {\r\n        const weekKey = `${format(startOfWeek(event.date, { weekStartsOn: 1 }), 'yyyy-MM-dd')}`;\r\n        if (!acc[weekKey]) acc[weekKey] = [];\r\n        acc[weekKey].push(event);\r\n        return acc;\r\n    }, {});\r\n\r\n    const headerTitle = (viewMode === 'week' || viewMode === 'list')\r\n        ? `Semana del ${format(weekStart, 'd MMM', { locale: es })} al ${format(weekEnd, 'd MMM', { locale: es })}`\r\n        : format(currentDate, 'MMMM yyyy', { locale: es });\r\n\r\n    return (\r\n        <div className=\"dashboard-container\">\r\n            <div className=\"dashboard-header\">\r\n                <div>\r\n                    <h1 className=\"page-title\">Calendario de Seguimiento</h1>\r\n                    <p className=\"page-subtitle\">Revisiones programadas de clientes</p>\r\n                </div>\r\n                <div className=\"flex bg-white border border-slate-200 shadow-sm p-1 rounded-lg\">\r\n                    <button\r\n                        onClick={() => setViewMode('list')}\r\n                        className={`p-2 rounded-md transition-colors flex gap-2 items-center text-sm font-medium ${viewMode === 'list' ? 'bg-slate-100 text-slate-900' : 'text-slate-400 hover:text-slate-600'}`}\r\n                    >\r\n                        <List size={18} /> Lista\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setViewMode('week')}\r\n                        className={`p-2 rounded-md transition-colors flex gap-2 items-center text-sm font-medium ${viewMode === 'week' ? 'bg-slate-100 text-slate-900' : 'text-slate-400 hover:text-slate-600'}`}\r\n                    >\r\n                        <LayoutGrid size={18} /> Semanal\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setViewMode('month')}\r\n                        className={`p-2 rounded-md transition-colors flex gap-2 items-center text-sm font-medium ${viewMode === 'month' ? 'bg-slate-100 text-slate-900' : 'text-slate-400 hover:text-slate-600'}`}\r\n                    >\r\n                        <CalendarIcon size={18} /> Mensual\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {viewMode !== 'list' ? (\r\n                <div className=\"card\">\r\n                    {/* Header */}\r\n                    <div className=\"flex items-center justify-between mb-8\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <h2 className=\"text-xl font-bold text-slate-800 capitalize\">\r\n                                {headerTitle}\r\n                            </h2>\r\n                            <div className=\"flex gap-1\">\r\n                                <button onClick={prevPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronLeft size={16} />\r\n                                </button>\r\n                                <button onClick={() => setCurrentDate(new Date())} className=\"btn btn-sm btn-outline border-slate-200\">\r\n                                    Hoy\r\n                                </button>\r\n                                <button onClick={nextPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronRight size={16} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Grid */}\r\n                    <div className=\"grid grid-cols-7 mb-2\">\r\n                        {weekDays.map(day => (\r\n                            <div key={day} className=\"text-center text-sm font-bold text-slate-400 uppercase tracking-wider py-2\">\r\n                                {day.substring(0, 3)}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-7 gap-px bg-slate-200 border border-slate-200 rounded-lg overflow-hidden\">\r\n                        {calendarDays.map((day, idx) => {\r\n                            const dayEvents = events.filter(e => isSameDay(e.date, day));\r\n                            const isCurrentMonth = isSameMonth(day, monthStart); // Only relevant for month view styling\r\n                            const isToday = isSameDay(day, new Date());\r\n\r\n                            // Adjust styling for week view vs month view\r\n                            const opacityClass = (viewMode === 'month' && !isCurrentMonth) ? 'bg-slate-50/50 text-slate-400' : '';\r\n                            const minHeightClass = viewMode === 'week' ? 'min-h-[400px]' : 'min-h-[120px]';\r\n\r\n                            return (\r\n                                <div\r\n                                    key={day.toString()}\r\n                                    className={`${minHeightClass} bg-white p-2 transition-colors hover:bg-slate-50 relative group ${opacityClass}`}\r\n                                >\r\n                                    <div className={`text-right text-sm font-medium mb-1 ${isToday ? 'bg-primary-600 text-white w-7 h-7 rounded-full flex items-center justify-center ml-auto shadow-sm' : ''}`}>\r\n                                        {format(day, 'd')}\r\n                                    </div>\r\n\r\n                                    <div className=\"space-y-1 overflow-y-auto max-h-[350px] scrollbar-thin\">\r\n                                        {dayEvents.map((evt, i) => (\r\n                                            <div\r\n                                                key={i}\r\n                                                className={`text-xs p-1.5 rounded border flex items-center gap-1.5 truncate shadow-sm transition-all group/evt\r\n                                                    ${evt.completed\r\n                                                        ? 'bg-green-50 text-green-700 border-green-200 opacity-75'\r\n                                                        : 'bg-primary-50 text-primary-700 border-primary-100 hover:bg-primary-100'\r\n                                                    }\r\n                                                `}\r\n                                            >\r\n                                                <button\r\n                                                    onClick={(e) => { e.stopPropagation(); handleToggleComplete(evt); }}\r\n                                                    className=\"flex-shrink-0 text-current hover:scale-110 transition-transform\"\r\n                                                    title={evt.completed ? \"Marcar como pendiente\" : \"Marcar como hecho\"}\r\n                                                >\r\n                                                    {evt.completed ? <CheckSquare size={12} /> : <Square size={12} />}\r\n                                                </button>\r\n                                                <span\r\n                                                    onClick={() => navigate(`/patients/${evt.patientId}`)}\r\n                                                    className={`font-medium truncate cursor-pointer hover:underline flex-1 ${evt.completed ? 'line-through' : ''}`}\r\n                                                    title={`Ver detalle de ${evt.patientName}`}\r\n                                                >\r\n                                                    {evt.patientName}\r\n                                                </span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                /* List View grouped by Week */\r\n                <div className=\"space-y-8\">\r\n                    {/* List View Navigation Header - Copied from Calendar View logic */}\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <h2 className=\"text-xl font-bold text-slate-800 capitalize\">\r\n                                {headerTitle}\r\n                            </h2>\r\n                            <div className=\"flex gap-1\">\r\n                                <button onClick={prevPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronLeft size={16} />\r\n                                </button>\r\n                                <button onClick={() => setCurrentDate(new Date())} className=\"btn btn-sm btn-outline border-slate-200\">\r\n                                    Hoy\r\n                                </button>\r\n                                <button onClick={nextPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronRight size={16} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {Object.keys(eventsByWeek).length === 0 ? (\r\n                        <div className=\"card text-center py-10 text-slate-500\">No hay revisiones programadas para esta semana.</div>\r\n                    ) : Object.keys(eventsByWeek).sort().map(weekKey => {\r\n                        // In list view strictly by week, this map will only run once or zero times\r\n                        const weekStart = new Date(weekKey);\r\n                        const weekEnd = endOfWeek(weekStart, { weekStartsOn: 1 });\r\n                        const weekEvents = eventsByWeek[weekKey];\r\n\r\n                        return (\r\n                            <div key={weekKey} className=\"card\">\r\n                                {/* Removed redundant week header since we have global navigation now,\r\n                                     but keeping simple header or removing completely?\r\n                                     Let's keep the card structure but remove the title if it's redundant\r\n                                     or keep it cleaner. Let's keep it simple. */}\r\n                                <div className=\"table-responsive\">\r\n                                    <table className=\"data-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th className=\"w-12 text-center\">Estado</th>\r\n                                                <th className=\"w-32\">Fecha</th>\r\n                                                <th className=\"w-48\">Cliente</th>\r\n                                                <th>Cambios a Realizar / Notas</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {weekEvents.map(evt => (\r\n                                                <tr key={evt.sysId} className={evt.completed ? 'bg-slate-50' : 'hover:bg-primary-50'}>\r\n                                                    <td className=\"text-center\">\r\n                                                        <button\r\n                                                            onClick={() => handleToggleComplete(evt)}\r\n                                                            className={`p-1 rounded transition-colors ${evt.completed ? 'text-green-600 hover:text-green-700' : 'text-slate-300 hover:text-slate-500'}`}\r\n                                                            title={evt.completed ? \"Marcar como pendiente\" : \"Marcar como hecho\"}\r\n                                                        >\r\n                                                            {evt.completed ? <CheckSquare size={20} /> : <Square size={20} />}\r\n                                                        </button>\r\n                                                    </td>\r\n                                                    <td className={`font-medium text-sm ${evt.completed ? 'text-slate-400 line-through' : 'text-slate-600'}`}>\r\n                                                        {format(evt.date, 'EEEE d', { locale: es })}\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <span\r\n                                                            onClick={() => navigate(`/patients/${evt.patientId}`)}\r\n                                                            className={`font-semibold cursor-pointer hover:text-primary transition-colors ${evt.completed ? 'text-slate-400 line-through' : 'text-slate-700'}`}\r\n                                                        >\r\n                                                            {evt.patientName}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <div className=\"relative group w-full\">\r\n                                                            <input\r\n                                                                type=\"text\"\r\n                                                                defaultValue={evt.notes}\r\n                                                                onBlur={(e) => handleNotesChange(evt.sysId, e.target.value)}\r\n                                                                onKeyDown={(e) => {\r\n                                                                    if (e.key === 'Enter') {\r\n                                                                        e.currentTarget.blur();\r\n                                                                    }\r\n                                                                }}\r\n                                                                className={`w-full bg-transparent border-b border-transparent hover:border-slate-200 focus:border-primary-400 outline-none py-1.5 px-2 text-sm transition-all ${evt.completed ? 'text-slate-400' : 'text-slate-700'}`}\r\n                                                                placeholder=\"Escribe cambios o notas...\"\r\n                                                            />\r\n                                                            <PenLine size={14} className=\"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none\" />\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TrackingCalendar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\context\\DataContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":5,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":5,"endColumn":21},{"ruleId":"no-dupe-keys","severity":2,"message":"Duplicate key 'exportData'.","line":223,"column":13,"nodeType":"ObjectExpression","messageId":"unexpected","endLine":223,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst DataContext = createContext();\r\n\r\nexport const useData = () => useContext(DataContext);\r\n\r\nconst STORAGE_KEY_PATIENTS = 'nutri_crm_patients';\r\nconst STORAGE_KEY_MARKETING = 'nutri_crm_marketing';\r\nconst STORAGE_KEY_TASKS = 'nutri_crm_tasks';\r\n\r\nexport const DataProvider = ({ children }) => {\r\n    const [patients, setPatients] = useState(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEY_PATIENTS);\r\n        if (saved) return JSON.parse(saved);\r\n\r\n        // Seed Data\r\n        return [\r\n            {\r\n                id: '1', name: 'Laura Martinez', age: 28, email: 'laura.mtz@mail.com', phone: '600 111 222',\r\n                subscription: { type: 'monthly', startDate: '2026-01-01', endDate: '2026-02-01', status: 'active' },\r\n                status: 'active', weight: 62.5, height: 165\r\n            },\r\n            {\r\n                id: '2', name: 'Carlos Ruiz', age: 35, email: 'carlos.gym@mail.com', phone: '600 333 444',\r\n                subscription: { type: 'quarterly', startDate: '2025-11-15', endDate: '2026-02-15', status: 'active' },\r\n                status: 'active', weight: 85.0, height: 180\r\n            },\r\n            {\r\n                id: '3', name: 'Ana Soria', age: 42, email: 'ana.soria@mail.com', phone: '600 555 666',\r\n                subscription: { type: 'biannual', startDate: '2025-08-01', endDate: '2026-01-28', status: 'active' }, // Expiring soon\r\n                status: 'active', weight: 58.0, height: 160\r\n            },\r\n            {\r\n                id: '4', name: 'Pedro Gomez', age: 29, email: 'pedro.g@mail.com', phone: '600 777 888',\r\n                subscription: { type: 'monthly', startDate: '2025-12-01', endDate: '2026-01-01', status: 'expired' },\r\n                status: 'active', weight: 92.5, height: 178\r\n            },\r\n            {\r\n                id: '5', name: 'Sofia Vega', age: 31, email: 'sofia.v@mail.com', phone: '600 999 000',\r\n                subscription: { type: 'monthly', startDate: '2026-01-20', endDate: '2026-02-20', status: 'active' },\r\n                status: 'active', weight: 67.0, height: 170\r\n            }\r\n        ];\r\n    });\r\n\r\n    const [marketingPosts, setMarketingPosts] = useState(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEY_MARKETING);\r\n        return saved ? JSON.parse(saved) : [];\r\n    });\r\n\r\n    const [plans, setPlans] = useState(() => {\r\n        const saved = localStorage.getItem('nutri_crm_plans');\r\n        return saved ? JSON.parse(saved) : [\r\n            { id: 'monthly', name: 'Mensual', days: 30, price: 50 },\r\n            { id: 'quarterly', name: 'Trimestral', days: 90, price: 135 },\r\n            { id: 'biannual', name: 'Semestral', days: 180, price: 250 },\r\n        ];\r\n    });\r\n\r\n    const [tasks, setTasks] = useState(() => {\r\n        const saved = localStorage.getItem(STORAGE_KEY_TASKS);\r\n        return saved ? JSON.parse(saved) : [];\r\n    });\r\n\r\n    // Persistence Effects\r\n    useEffect(() => {\r\n        localStorage.setItem(STORAGE_KEY_PATIENTS, JSON.stringify(patients));\r\n    }, [patients]);\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem(STORAGE_KEY_MARKETING, JSON.stringify(marketingPosts));\r\n    }, [marketingPosts]);\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('nutri_crm_plans', JSON.stringify(plans));\r\n    }, [plans]);\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem(STORAGE_KEY_TASKS, JSON.stringify(tasks));\r\n    }, [tasks]);\r\n\r\n    // --- Patient Actions ---\r\n    const addPatient = (patient) => {\r\n        const newPatient = {\r\n            ...patient,\r\n            id: crypto.randomUUID(),\r\n            createdAt: new Date().toISOString(),\r\n            measurements: [], // History of measurements\r\n            photos: [],\r\n            status: 'active', // active, archived\r\n            subscription: null // { type: 'monthly', startDate: '...', endDate: '...' }\r\n        };\r\n        setPatients((prev) => [...prev, newPatient]);\r\n        return newPatient.id;\r\n    };\r\n\r\n    const updatePatient = (id, updates) => {\r\n        setPatients((prev) => prev.map(p => p.id === id ? { ...p, ...updates } : p));\r\n    };\r\n\r\n    const deletePatient = (id) => {\r\n        if (confirm('¿Estás seguro de eliminar este cliente y todos sus datos?')) {\r\n            setPatients((prev) => prev.filter(p => p.id !== id));\r\n        }\r\n    };\r\n\r\n    const addMeasurement = (patientId, measurement) => {\r\n        setPatients((prev) => prev.map(p => {\r\n            if (p.id !== patientId) return p;\r\n            return {\r\n                ...p,\r\n                measurements: [...(p.measurements || []), { ...measurement, id: crypto.randomUUID(), date: measurement.date || new Date().toISOString() }]\r\n            };\r\n        }));\r\n    };\r\n\r\n    // --- Marketing Actions ---\r\n    const addPost = (post) => {\r\n        setMarketingPosts((prev) => [...prev, { ...post, id: crypto.randomUUID() }]);\r\n    };\r\n\r\n    const updatePost = (id, updates) => {\r\n        setMarketingPosts((prev) => prev.map(p => p.id === id ? { ...p, ...updates } : p));\r\n    };\r\n\r\n    const deletePost = (id) => {\r\n        setMarketingPosts((prev) => prev.filter(p => p.id !== id));\r\n    };\r\n\r\n    // --- Plan Actions ---\r\n    const addPlan = (plan) => {\r\n        setPlans((prev) => [...prev, { ...plan, id: crypto.randomUUID(), status: 'active' }]);\r\n    };\r\n\r\n    const updatePlan = (id, updates) => {\r\n        setPlans((prev) => prev.map(p => p.id === id ? { ...p, ...updates } : p));\r\n    };\r\n\r\n    const deletePlan = (id) => {\r\n        setPlans((prev) => prev.filter(p => p.id !== id));\r\n    };\r\n\r\n    // --- Task Actions ---\r\n    const addTask = (task) => {\r\n        setTasks((prev) => [...prev, { ...task, id: crypto.randomUUID(), completed: false, createdAt: new Date().toISOString() }]);\r\n    };\r\n\r\n    const updateTask = (id, updates) => {\r\n        setTasks((prev) => prev.map(t => t.id === id ? { ...t, ...updates } : t));\r\n    };\r\n\r\n    const deleteTask = (id) => {\r\n        setTasks((prev) => prev.filter(t => t.id !== id));\r\n    };\r\n\r\n    const [reviews, setReviews] = useState(() => {\r\n        const saved = localStorage.getItem('nutri_crm_reviews');\r\n        return saved ? JSON.parse(saved) : {}; // Object keyed by reviewId\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('nutri_crm_reviews', JSON.stringify(reviews));\r\n    }, [reviews]);\r\n\r\n    const saveReview = (reviewId, data) => {\r\n        setReviews(prev => ({\r\n            ...prev,\r\n            [reviewId]: { ...prev[reviewId], ...data, id: reviewId }\r\n        }));\r\n    };\r\n\r\n    // --- Export/Import ---\r\n    const exportData = () => {\r\n        const data = {\r\n            patients,\r\n            marketingPosts,\r\n            plans,\r\n            reviews,\r\n            version: 1,\r\n            exportedAt: new Date().toISOString()\r\n        };\r\n        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `nutri_crm_backup_${new Date().toISOString().split('T')[0]}.json`;\r\n        a.click();\r\n    };\r\n\r\n    const importData = (jsonData) => {\r\n        try {\r\n            const data = JSON.parse(jsonData);\r\n            if (data.patients) setPatients(data.patients);\r\n            if (data.marketingPosts) setMarketingPosts(data.marketingPosts);\r\n            if (data.marketingPosts) setMarketingPosts(data.marketingPosts);\r\n            if (data.plans) setPlans(data.plans);\r\n            if (data.tasks) setTasks(data.tasks);\r\n            if (data.reviews) setReviews(data.reviews);\r\n            alert('Datos importados correctamente');\r\n        } catch (e) {\r\n            alert('Error al importar datos: ' + e.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <DataContext.Provider value={{\r\n            patients,\r\n            addPatient,\r\n            updatePatient,\r\n            deletePatient,\r\n            addMeasurement,\r\n            marketingPosts,\r\n            addPost,\r\n            updatePost,\r\n            deletePost,\r\n            plans,\r\n            addPlan,\r\n            updatePlan,\r\n            deletePlan,\r\n            reviews,\r\n            saveReview,\r\n            exportData,\r\n            exportData,\r\n            importData,\r\n            tasks,\r\n            addTask,\r\n            updateTask,\r\n            deleteTask\r\n        }}>\r\n            {children}\r\n        </DataContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\context\\ThemeContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":52,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":52,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState } from 'react';\r\n\r\nconst initialState = {\r\n    theme: 'light',\r\n    setTheme: () => null,\r\n};\r\n\r\nconst ThemeContext = createContext(initialState);\r\n\r\nexport function ThemeProvider({\r\n    children,\r\n    defaultTheme = 'light',\r\n    storageKey = 'vite-ui-theme',\r\n}) {\r\n    const [theme, setTheme] = useState(\r\n        () => localStorage.getItem(storageKey) || defaultTheme\r\n    );\r\n\r\n    useEffect(() => {\r\n        const root = window.document.documentElement;\r\n\r\n        root.classList.remove('light', 'dark');\r\n\r\n        if (theme === 'system') {\r\n            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)')\r\n                .matches\r\n                ? 'dark'\r\n                : 'light';\r\n\r\n            root.classList.add(systemTheme);\r\n            return;\r\n        }\r\n\r\n        root.classList.add(theme);\r\n    }, [theme]);\r\n\r\n    const value = {\r\n        theme,\r\n        setTheme: (theme) => {\r\n            localStorage.setItem(storageKey, theme);\r\n            setTheme(theme);\r\n        },\r\n    };\r\n\r\n    return (\r\n        <ThemeContext.Provider value={value}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useTheme = () => {\r\n    const context = useContext(ThemeContext);\r\n\r\n    if (context === undefined)\r\n        throw new Error(\"useTheme must be used within a ThemeProvider\");\r\n\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\utils\\cn.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
