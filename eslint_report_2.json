[{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\postcss.config.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Dashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Layout.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":22,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[464,475],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Outlet, useLocation, Link } from 'react-router-dom';\r\nimport {\r\n    LayoutDashboard,\r\n    Users,\r\n    CalendarDays,\r\n    Megaphone,\r\n    Settings,\r\n    LogOut,\r\n    Menu,\r\n    X,\r\n    UserCircle,\r\n    Activity,\r\n    Repeat,\r\n    PieChart,\r\n    ClipboardList\r\n} from 'lucide-react';\r\nimport { useState } from 'react';\r\nimport { cn } from '../utils/cn';\r\nimport { ThemeToggle } from './ThemeToggle.jsx';\r\n\r\n// Sidebar Item Component\r\nconst SidebarItem = ({ icon: Icon, label, path, active }) => (\r\n    <Link\r\n        to={path}\r\n        className={cn(\r\n            \"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors mb-1\",\r\n            active\r\n                ? \"bg-primary-50 text-primary-700 font-medium dark:bg-primary-900/20 dark:text-primary-400\"\r\n                : \"text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-400 dark:hover:bg-slate-800 dark:hover:text-slate-50\"\r\n        )}\r\n    >\r\n        <Icon className=\"w-5 h-5\" />\r\n        <span>{label}</span>\r\n    </Link>\r\n);\r\n\r\nconst Sidebar = ({ isOpen, onClose }) => {\r\n    const location = useLocation();\r\n\r\n    // Adapted Navigation Items for Nutri CRM\r\n    const navItems = [\r\n        { icon: LayoutDashboard, label: 'Dashboard', path: '/' },\r\n        { icon: Users, label: 'Clientes', path: '/patients' },\r\n        { icon: Activity, label: 'Seguimiento', path: '/tracking' },\r\n        { icon: Repeat, label: 'Renovaciones', path: '/renewals' },\r\n        { icon: ClipboardList, label: 'Tareas', path: '/tasks' },\r\n        { icon: Megaphone, label: 'Marketing', path: '/marketing' },\r\n        { icon: PieChart, label: 'Estadísticas', path: '/statistics' },\r\n        { icon: CalendarDays, label: 'Calendario', path: '/calendar' }, // Future feature?\r\n        { icon: Settings, label: 'Configuración', path: '/settings' },\r\n    ];\r\n\r\n    // Handle Closing on Mobile Navigation\r\n    const handleNavClick = () => {\r\n        if (window.innerWidth < 768) {\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Mobile Overlay */}\r\n            {isOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/50 z-20 md:hidden transition-opacity\"\r\n                    onClick={onClose}\r\n                />\r\n            )}\r\n\r\n            {/* Sidebar */}\r\n            <div className={cn(\r\n                \"w-64 h-full bg-white border-r border-slate-200 flex flex-col fixed left-0 top-0 transition-transform duration-300 z-30 dark:bg-slate-900 dark:border-slate-800\",\r\n                isOpen ? \"translate-x-0\" : \"-translate-x-full md:translate-x-0\"\r\n            )}>\r\n                <div className=\"p-6 flex items-center justify-between border-b border-slate-100 dark:border-slate-800\">\r\n                    <div className=\"flex items-center justify-center flex-1\">\r\n                        <div className=\"flex flex-col items-center justify-center py-2\">\r\n                            <img src=\"/logo-rosa.png\" alt=\"NutriCRM Logo\" className=\"h-16 w-auto object-contain mb-2\" />\r\n                            <span className=\"text-sm font-bold text-primary-700 tracking-widest uppercase\">Iris Nutrición</span>\r\n                        </div>\r\n                    </div>\r\n                    <button onClick={onClose} className=\"md:hidden p-1 text-slate-500\">\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <nav className=\"flex-1 overflow-y-auto p-4\">\r\n                    {navItems.map((item) => (\r\n                        <div key={item.path} onClick={handleNavClick}>\r\n                            <SidebarItem\r\n                                icon={item.icon}\r\n                                label={item.label}\r\n                                path={item.path}\r\n                                active={location.pathname === item.path || (item.path !== '/' && location.pathname.startsWith(item.path))}\r\n                            />\r\n                        </div>\r\n                    ))}\r\n                </nav>\r\n\r\n                <div className=\"p-4 border-t border-slate-100 dark:border-slate-800\">\r\n                    <div className=\"flex items-center space-x-3 px-3 py-2\">\r\n                        <div className=\"bg-primary-100 p-2 rounded-full dark:bg-primary-900/30\">\r\n                            <UserCircle className=\"w-5 h-5 text-primary-600 dark:text-primary-400\" />\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"text-sm font-medium text-slate-900 truncate dark:text-slate-200\">Dra. Iris</p>\r\n                            <p className=\"text-xs text-slate-500 truncate capitalize dark:text-slate-400\">Nutricionista</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default function Layout() {\r\n    const [sidebarOpen, setSidebarOpen] = useState(false);\r\n\r\n    // Mock Logout\r\n    const handleLogout = () => {\r\n        console.log(\"Logout clicked\");\r\n        // Could implement real logout if needed\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 transition-colors duration-300 dark:bg-slate-950\">\r\n            <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\r\n\r\n            <div className=\"md:pl-64 flex flex-col min-h-screen transition-all duration-300\">\r\n                <header className=\"h-16 bg-white border-b border-slate-200 flex items-center justify-between md:justify-end px-4 md:px-8 sticky top-0 z-10 transition-colors duration-300 gap-4 dark:bg-slate-900 dark:border-slate-800\">\r\n                    {/* Mobile Menu Button */}\r\n                    <button\r\n                        className=\"md:hidden p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-lg dark:text-slate-400 dark:hover:bg-slate-800\"\r\n                        onClick={() => setSidebarOpen(true)}\r\n                    >\r\n                        <Menu className=\"w-6 h-6\" />\r\n                    </button>\r\n\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <ThemeToggle />\r\n                        <div className=\"h-6 w-px bg-slate-200 dark:bg-slate-700\" aria-hidden=\"true\" />\r\n                        <button\r\n                            onClick={handleLogout}\r\n                            className=\"flex items-center space-x-2 text-sm text-slate-600 hover:text-red-600 transition-colors dark:text-slate-400 dark:hover:text-red-400\"\r\n                        >\r\n                            <LogOut className=\"w-4 h-4\" />\r\n                            <span className=\"hidden sm:inline\">Cerrar Sesión</span>\r\n                        </button>\r\n                    </div>\r\n                </header>\r\n                <main className=\"flex-1 p-4 md:p-8 overflow-x-hidden\">\r\n                    <Outlet />\r\n                </main>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\CalendarPost.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\ContentCalendar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\Marketing.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Marketing\\NewPostModal.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  14 |             if (initialData) {\n  15 |                 // eslint-disable-next-line react-hooks/set-state-in-effect\n> 16 |                 setPost(initialData);\n     |                 ^^^^^^^ Avoid calling setState() directly within an effect\n  17 |             } else {\n  18 |                 setPost({\n  19 |                     date: selectedDate ? selectedDate.toISOString().split('T')[0] : new Date().toISOString().split('T')[0],","line":16,"column":17,"nodeType":null,"endLine":16,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Patients\\PatientDetail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Patients\\PatientForm.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  32 |             if (patient) {\n  33 |                 // eslint-disable-next-line react-hooks/set-state-in-effect\n> 34 |                 setFormData({\n     |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  35 |                     name: patient.name || '',\n  36 |                     age: patient.age || '',\n  37 |                     sex: patient.sex || 'mujer',","line":34,"column":17,"nodeType":null,"endLine":34,"endColumn":28,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Patients\\PatientList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Renewals\\Renewals.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Settings\\Settings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Settings\\Statistics.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tasks\\Tasks.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\ThemeToggle.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tracking\\EvolutionChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tracking\\MeasurementModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\components\\Tracking\\TrackingCalendar.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'weekEnd' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":247,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":247,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"weekEnd"},"fix":{"range":[13555,13613],"text":""},"desc":"Remove unused variable 'weekEnd'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useData } from '../../context/DataContext';\r\nimport { addDays, format, startOfWeek, endOfWeek, startOfMonth, endOfMonth, eachDayOfInterval, isSameMonth, isSameDay, parseISO } from 'date-fns';\r\nimport { es } from 'date-fns/locale';\r\nimport { ChevronLeft, ChevronRight, Calendar as CalendarIcon, List, LayoutGrid, CheckSquare, Square, PenLine } from 'lucide-react';\r\n\r\nconst TrackingCalendar = () => {\r\n    const { patients, reviews, saveReview } = useData();\r\n    const navigate = useNavigate();\r\n    const [currentDate, setCurrentDate] = useState(new Date());\r\n    const [viewMode, setViewMode] = useState('week'); // Default to 'week'\r\n\r\n    // Generate Review Events\r\n    const events = patients.flatMap(patient => {\r\n        if (!patient.subscription?.startDate) return [];\r\n\r\n        const start = parseISO(patient.subscription.startDate);\r\n        const end = patient.subscription.endDate ? parseISO(patient.subscription.endDate) : addDays(start, 30); // Default or actual end\r\n        const patientEvents = [];\r\n\r\n        // Generate weekly reviews from start date\r\n        let reviewDate = addDays(start, 7);\r\n        while (reviewDate <= end) {\r\n            const reviewId = `review_${patient.id}_${format(reviewDate, 'yyyy-MM-dd')}`;\r\n            const savedData = reviews?.[reviewId] || {};\r\n\r\n            patientEvents.push({\r\n                sysId: reviewId,\r\n                date: reviewDate,\r\n                patientName: patient.name,\r\n                patientId: patient.id,\r\n                type: 'Revisión',\r\n                completed: savedData.completed || false,\r\n                notes: savedData.notes || ''\r\n            });\r\n            reviewDate = addDays(reviewDate, 7);\r\n        }\r\n        return patientEvents;\r\n    });\r\n\r\n    // Toggle Complete\r\n    const handleToggleComplete = (evt) => {\r\n        saveReview(evt.sysId, { completed: !evt.completed });\r\n    };\r\n\r\n    // Save Notes\r\n    const handleNotesChange = (sysId, note) => {\r\n        saveReview(sysId, { notes: note });\r\n    };\r\n\r\n    // Calendar Navigation\r\n    const nextPeriod = () => {\r\n        if (viewMode === 'week' || viewMode === 'list') {\r\n            setCurrentDate(addDays(currentDate, 7));\r\n        } else {\r\n            const next = new Date(currentDate);\r\n            next.setMonth(currentDate.getMonth() + 1);\r\n            setCurrentDate(next);\r\n        }\r\n    };\r\n\r\n    const prevPeriod = () => {\r\n        if (viewMode === 'week' || viewMode === 'list') {\r\n            setCurrentDate(addDays(currentDate, -7));\r\n        } else {\r\n            const prev = new Date(currentDate);\r\n            prev.setMonth(currentDate.getMonth() - 1);\r\n            setCurrentDate(prev);\r\n        }\r\n    };\r\n\r\n    // View Logic Dates\r\n    const monthStart = startOfMonth(currentDate);\r\n    const monthEnd = endOfMonth(monthStart);\r\n    const monthStartDate = startOfWeek(monthStart, { weekStartsOn: 1 });\r\n    const monthEndDate = endOfWeek(monthEnd, { weekStartsOn: 1 });\r\n\r\n    const weekStart = startOfWeek(currentDate, { weekStartsOn: 1 });\r\n\r\n    // Determine days to render based on viewMode\r\n    const calendarDays = viewMode === 'week'\r\n        ? eachDayOfInterval({ start: weekStart, end: endOfWeek(currentDate, { weekStartsOn: 1 }) })\r\n        : eachDayOfInterval({ start: monthStartDate, end: monthEndDate });\r\n\r\n    const weekDays = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];\r\n\r\n    // List View Grouping\r\n    const sortedEvents = [...events].sort((a, b) => a.date - b.date);\r\n\r\n    // Filter events for List View: Only show events for the CURRENT selected week (defined by weekStart and weekEnd)\r\n    const validListEvents = sortedEvents.filter(evt => {\r\n        return evt.date >= weekStart && evt.date <= endOfWeek(currentDate, { weekStartsOn: 1 });\r\n    });\r\n\r\n    const eventsByWeek = validListEvents.reduce((acc, event) => {\r\n        const weekKey = `${format(startOfWeek(event.date, { weekStartsOn: 1 }), 'yyyy-MM-dd')}`;\r\n        if (!acc[weekKey]) acc[weekKey] = [];\r\n        acc[weekKey].push(event);\r\n        return acc;\r\n    }, {});\r\n\r\n    const headerTitle = (viewMode === 'week' || viewMode === 'list')\r\n        ? `Semana del ${format(weekStart, 'd MMM', { locale: es })} al ${format(endOfWeek(currentDate, { weekStartsOn: 1 }), 'd MMM', { locale: es })}`\r\n        : format(currentDate, 'MMMM yyyy', { locale: es });\r\n\r\n    return (\r\n        <div className=\"dashboard-container\">\r\n            <div className=\"dashboard-header\">\r\n                <div>\r\n                    <h1 className=\"page-title\">Calendario de Seguimiento</h1>\r\n                    <p className=\"page-subtitle\">Revisiones programadas de clientes</p>\r\n                </div>\r\n                <div className=\"flex bg-white border border-slate-200 shadow-sm p-1 rounded-lg\">\r\n                    <button\r\n                        onClick={() => setViewMode('list')}\r\n                        className={`p-2 rounded-md transition-colors flex gap-2 items-center text-sm font-medium ${viewMode === 'list' ? 'bg-slate-100 text-slate-900' : 'text-slate-400 hover:text-slate-600'}`}\r\n                    >\r\n                        <List size={18} /> Lista\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setViewMode('week')}\r\n                        className={`p-2 rounded-md transition-colors flex gap-2 items-center text-sm font-medium ${viewMode === 'week' ? 'bg-slate-100 text-slate-900' : 'text-slate-400 hover:text-slate-600'}`}\r\n                    >\r\n                        <LayoutGrid size={18} /> Semanal\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setViewMode('month')}\r\n                        className={`p-2 rounded-md transition-colors flex gap-2 items-center text-sm font-medium ${viewMode === 'month' ? 'bg-slate-100 text-slate-900' : 'text-slate-400 hover:text-slate-600'}`}\r\n                    >\r\n                        <CalendarIcon size={18} /> Mensual\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {viewMode !== 'list' ? (\r\n                <div className=\"card\">\r\n                    {/* Header */}\r\n                    <div className=\"flex items-center justify-between mb-8\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <h2 className=\"text-xl font-bold text-slate-800 capitalize\">\r\n                                {headerTitle}\r\n                            </h2>\r\n                            <div className=\"flex gap-1\">\r\n                                <button onClick={prevPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronLeft size={16} />\r\n                                </button>\r\n                                <button onClick={() => setCurrentDate(new Date())} className=\"btn btn-sm btn-outline border-slate-200\">\r\n                                    Hoy\r\n                                </button>\r\n                                <button onClick={nextPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronRight size={16} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Grid */}\r\n                    <div className=\"grid grid-cols-7 mb-2\">\r\n                        {weekDays.map(day => (\r\n                            <div key={day} className=\"text-center text-sm font-bold text-slate-400 uppercase tracking-wider py-2\">\r\n                                {day.substring(0, 3)}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-7 gap-px bg-slate-200 border border-slate-200 rounded-lg overflow-hidden\">\r\n                        {calendarDays.map((day) => {\r\n                            const dayEvents = events.filter(e => isSameDay(e.date, day));\r\n                            const isCurrentMonth = isSameMonth(day, monthStart); // Only relevant for month view styling\r\n                            const isToday = isSameDay(day, new Date());\r\n\r\n                            // Adjust styling for week view vs month view\r\n                            const opacityClass = (viewMode === 'month' && !isCurrentMonth) ? 'bg-slate-50/50 text-slate-400' : '';\r\n                            const minHeightClass = viewMode === 'week' ? 'min-h-[400px]' : 'min-h-[120px]';\r\n\r\n                            return (\r\n                                <div\r\n                                    key={day.toString()}\r\n                                    className={`${minHeightClass} bg-white p-2 transition-colors hover:bg-slate-50 relative group ${opacityClass}`}\r\n                                >\r\n                                    <div className={`text-right text-sm font-medium mb-1 ${isToday ? 'bg-primary-600 text-white w-7 h-7 rounded-full flex items-center justify-center ml-auto shadow-sm' : ''}`}>\r\n                                        {format(day, 'd')}\r\n                                    </div>\r\n\r\n                                    <div className=\"space-y-1 overflow-y-auto max-h-[350px] scrollbar-thin\">\r\n                                        {dayEvents.map((evt, i) => (\r\n                                            <div\r\n                                                key={i}\r\n                                                className={`text-xs p-1.5 rounded border flex items-center gap-1.5 truncate shadow-sm transition-all group/evt\r\n                                                    ${evt.completed\r\n                                                        ? 'bg-green-50 text-green-700 border-green-200 opacity-75'\r\n                                                        : 'bg-primary-50 text-primary-700 border-primary-100 hover:bg-primary-100'\r\n                                                    }\r\n                                                `}\r\n                                            >\r\n                                                <button\r\n                                                    onClick={(e) => { e.stopPropagation(); handleToggleComplete(evt); }}\r\n                                                    className=\"flex-shrink-0 text-current hover:scale-110 transition-transform\"\r\n                                                    title={evt.completed ? \"Marcar como pendiente\" : \"Marcar como hecho\"}\r\n                                                >\r\n                                                    {evt.completed ? <CheckSquare size={12} /> : <Square size={12} />}\r\n                                                </button>\r\n                                                <span\r\n                                                    onClick={() => navigate(`/patients/${evt.patientId}`)}\r\n                                                    className={`font-medium truncate cursor-pointer hover:underline flex-1 ${evt.completed ? 'line-through' : ''}`}\r\n                                                    title={`Ver detalle de ${evt.patientName}`}\r\n                                                >\r\n                                                    {evt.patientName}\r\n                                                </span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                /* List View grouped by Week */\r\n                <div className=\"space-y-8\">\r\n                    {/* List View Navigation Header - Copied from Calendar View logic */}\r\n                    <div className=\"flex items-center justify-between mb-4\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <h2 className=\"text-xl font-bold text-slate-800 capitalize\">\r\n                                {headerTitle}\r\n                            </h2>\r\n                            <div className=\"flex gap-1\">\r\n                                <button onClick={prevPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronLeft size={16} />\r\n                                </button>\r\n                                <button onClick={() => setCurrentDate(new Date())} className=\"btn btn-sm btn-outline border-slate-200\">\r\n                                    Hoy\r\n                                </button>\r\n                                <button onClick={nextPeriod} className=\"btn btn-sm btn-outline px-2 border-slate-200\">\r\n                                    <ChevronRight size={16} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {Object.keys(eventsByWeek).length === 0 ? (\r\n                        <div className=\"card text-center py-10 text-slate-500\">No hay revisiones programadas para esta semana.</div>\r\n                    ) : Object.keys(eventsByWeek).sort().map(weekKey => {\r\n                        // In list view strictly by week, this map will only run once or zero times\r\n                        const weekStart = new Date(weekKey);\r\n                        const weekEnd = endOfWeek(weekStart, { weekStartsOn: 1 });\r\n                        const weekEvents = eventsByWeek[weekKey];\r\n\r\n                        return (\r\n                            <div key={weekKey} className=\"card\">\r\n                                {/* Removed redundant week header since we have global navigation now,\r\n                                     but keeping simple header or removing completely?\r\n                                     Let's keep the card structure but remove the title if it's redundant\r\n                                     or keep it cleaner. Let's keep it simple. */}\r\n                                <div className=\"table-responsive\">\r\n                                    <table className=\"data-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th className=\"w-12 text-center\">Estado</th>\r\n                                                <th className=\"w-32\">Fecha</th>\r\n                                                <th className=\"w-48\">Cliente</th>\r\n                                                <th>Cambios a Realizar / Notas</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {weekEvents.map(evt => (\r\n                                                <tr key={evt.sysId} className={evt.completed ? 'bg-slate-50' : 'hover:bg-primary-50'}>\r\n                                                    <td className=\"text-center\">\r\n                                                        <button\r\n                                                            onClick={() => handleToggleComplete(evt)}\r\n                                                            className={`p-1 rounded transition-colors ${evt.completed ? 'text-green-600 hover:text-green-700' : 'text-slate-300 hover:text-slate-500'}`}\r\n                                                            title={evt.completed ? \"Marcar como pendiente\" : \"Marcar como hecho\"}\r\n                                                        >\r\n                                                            {evt.completed ? <CheckSquare size={20} /> : <Square size={20} />}\r\n                                                        </button>\r\n                                                    </td>\r\n                                                    <td className={`font-medium text-sm ${evt.completed ? 'text-slate-400 line-through' : 'text-slate-600'}`}>\r\n                                                        {format(evt.date, 'EEEE d', { locale: es })}\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <span\r\n                                                            onClick={() => navigate(`/patients/${evt.patientId}`)}\r\n                                                            className={`font-semibold cursor-pointer hover:text-primary transition-colors ${evt.completed ? 'text-slate-400 line-through' : 'text-slate-700'}`}\r\n                                                        >\r\n                                                            {evt.patientName}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <div className=\"relative group w-full\">\r\n                                                            <input\r\n                                                                type=\"text\"\r\n                                                                defaultValue={evt.notes}\r\n                                                                onBlur={(e) => handleNotesChange(evt.sysId, e.target.value)}\r\n                                                                onKeyDown={(e) => {\r\n                                                                    if (e.key === 'Enter') {\r\n                                                                        e.currentTarget.blur();\r\n                                                                    }\r\n                                                                }}\r\n                                                                className={`w-full bg-transparent border-b border-transparent hover:border-slate-200 focus:border-primary-400 outline-none py-1.5 px-2 text-sm transition-all ${evt.completed ? 'text-slate-400' : 'text-slate-700'}`}\r\n                                                                placeholder=\"Escribe cambios o notas...\"\r\n                                                            />\r\n                                                            <PenLine size={14} className=\"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none\" />\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TrackingCalendar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\context\\DataContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":6,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":6,"endColumn":21,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\context\\ThemeContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":53,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":53,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\src\\utils\\cn.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Iris Del Rosario\\Desktop\\APP NUTRICION\\nutri-crm\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
